<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta http-equiv="content-language" content="th">
  <meta name="geo.region" content="TH">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@200;300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />
  
  <style>
    :root {
      --bg-color: #002C66;
      --card-bg: #03459D;
      --text-main: #FFFFFF;
      --text-sec: #F5F5F7;
      --accent: #2997FF;
      --nav-bg: rgba(3, 69, 157, 0.85);
      --border: 1px solid rgba(255, 255, 255, 0.12);
      --radius: 20px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
    
    body {
      background-color: var(--bg-color);
      font-family: 'Kanit', sans-serif;
      font-weight: 300;
      color: var(--text-main);
      padding-top: 60px;
      padding-bottom: 80px;
      overflow-x: hidden;
    }

    #loader-overlay {
      position: fixed; inset: 0; background-color: #000000; z-index: 9999;
      display: flex; justify-content: center; align-items: center;
      transition: opacity 0.8s cubic-bezier(0.6, 0.05, 0.2, 1), visibility 0.8s;
    }
    body.loaded #loader-overlay { opacity: 0; visibility: hidden; pointer-events: none; }

    nav {
      position: fixed; top: 0; left: 0; right: 0; height: 60px;
      background: var(--nav-bg); backdrop-filter: blur(20px);
      border-bottom: var(--border); z-index: 1000;
      display: flex; align-items: center; justify-content: center;
    }

    .nav-content {
      width: 100%; max-width: 1200px; padding: 0 20px;
      display: flex; justify-content: space-between; align-items: center;
    }

    .logo { display:flex; align-items:center; gap:8px; cursor:pointer; }
    .logo img { height:42px; width:auto; }
    .logo span { font-size:20px; font-weight:600; }

    .nav-links { display:flex; gap:24px; }
    .nav-item { font-size:18px; color:var(--text-sec); cursor:pointer; }
    .nav-item.active, .nav-item:hover { color:#fff; font-weight:500; }

    .page-section {
      display:none;
      max-width:1200px;
      margin:0 auto;
      padding:20px;
    }
    .page-section.active {
      display:grid;
      grid-template-columns:repeat(4,1fr);
      gap:32px;
    }

    .card {
      background:var(--card-bg);
      border:var(--border);
      border-radius:var(--radius);
      padding:30px;
      display:flex;
      flex-direction:column;
      min-height:280px;
    }

    .icon {
      width:48px;
      height:48px;
      object-fit:contain;
      margin-bottom:16px;
      display:block;
    }

    /* Step 1: fix icon (ไม่แตะ structure) */
    .card[data-type="service"] .icon,
    .card[data-type="for-sale"] .icon,
    .card[data-type="for-rent"] .icon {
      width:100%;
      height:180px;
      object-fit:cover;
      border-radius:12px;
      margin-bottom:20px;
    }

    @media (min-width:900px) {
      .span-full { grid-column:1 / -1; }
      .span-2x2 { grid-column:span 2; grid-row:span 2; }
      .span-2x1 { grid-column:span 2; }
      .span-1x2 { grid-row:span 2; }
    }

    @media (max-width:899px) {
      .page-section.active { grid-template-columns:1fr; }
      .span-full,.span-2x2,.span-2x1,.span-1x2 { grid-column:1 / -1; }
    }
  </style>
</head>

<body>

<div id="loader-overlay"></div>

<nav>
  <div class="nav-content">
    <div class="logo" onclick="switchPage('home')">
      <img src="https://raw.githubusercontent.com/PropWorksTH/Pics/main/Logo.png">
      <span>PropWorks</span>
    </div>
    <div class="nav-links">
      <div class="nav-item active" onclick="switchPage('home')">Home</div>
      <div class="nav-item" onclick="switchPage('services')">Services</div>
      <div class="nav-item" onclick="switchPage('listings')">Listings</div>
      <div class="nav-item" onclick="switchPage('close-a-deal')">Close a Deal</div>
      <div class="nav-item" onclick="switchPage('about')">About</div>
      <div class="nav-item" onclick="switchPage('contact')">Contact</div>
    </div>
  </div>
</nav>

<main id="home-page" class="page-section"></main>
<main id="services-page" class="page-section"></main>
<main id="listings-page" class="page-section"></main>
<main id="close-a-deal-page" class="page-section"></main>
<main id="about-page" class="page-section"></main>
<main id="contact-page" class="page-section"></main>

<script>
let allData = [];

window.onload = function(){
  google.script.run.withSuccessHandler(initApp).getData();
};

function initApp(data){
  allData = data;
  ['home','services','listings','close-a-deal','about','contact'].forEach(renderPage);
  switchPage('home');
  document.body.classList.add('loaded');
}

function renderPage(page){
  const container = document.getElementById(`${page}-page`);
  container.innerHTML = '';
  allData.filter(i=>i.page===page).forEach(i=>{
    const card = document.createElement('div');
    card.className = `card span-1x1`;
    card.dataset.type = String(i.type||'').toLowerCase();
    const img = i.iconUrl ? `<img class="icon" src="${i.iconUrl}">` : '';
    card.innerHTML = `${img}<h2>${i.title||''}</h2><p>${i.subtitle||''}</p>`;
    container.appendChild(card);
  });
}

function switchPage(p){
  document.querySelectorAll('.page-section').forEach(e=>e.classList.remove('active'));
  document.getElementById(`${p}-page`)?.classList.add('active');
  window.scrollTo(0,0);
}
</script>

</body>
</html>
